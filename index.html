<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="ScreenPad">
  <meta name="theme-color" content="#1e1e1e">
  <title>ScreenPad</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{background:#111;color:#eee;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;
      min-height:100vh;padding:env(safe-area-inset-top,20px) 16px 20px;display:flex;flex-direction:column;align-items:center;}
    h1{font-size:24px;margin:30px 0 8px;text-align:center;}
    .sub{color:#888;font-size:14px;margin-bottom:30px;text-align:center;}
    .section{background:#1a1a2e;border:1px solid #333;border-radius:12px;padding:20px;margin-bottom:16px;width:100%;max-width:500px;}
    .section h2{font-size:16px;margin-bottom:12px;color:#5af;}
    .step{margin-bottom:10px;font-size:14px;line-height:1.6;color:#ccc;}
    .step b{color:#fff;}
    .url-box{background:#222;border:1px solid #444;border-radius:8px;padding:10px;font-size:12px;
      color:#0f0;word-break:break-all;margin:8px 0;font-family:'SF Mono',monospace;user-select:all;-webkit-user-select:all;}
    .btn-row{display:flex;gap:8px;margin-top:16px;}
    .btn{flex:1;padding:12px;border:none;border-radius:8px;font-size:15px;font-weight:600;cursor:pointer;text-align:center;text-decoration:none;display:block;}
    .btn-primary{background:#2563eb;color:#fff;}
    .btn-primary:active{background:#1d4ed8;}
    .btn-secondary{background:#333;color:#eee;border:1px solid #555;}
    .btn-secondary:active{background:#444;}
    .demo{padding:16px;text-align:center;}
    .demo button{padding:10px 24px;background:#2563eb;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;}
    .demo button:active{background:#1d4ed8;}
    .note{font-size:12px;color:#666;text-align:center;margin-top:10px;line-height:1.5;}
  </style>
</head>
<body>
  <h1>⌨ ScreenPad</h1>
  <p class="sub">모바일 브라우저 게임용 가상 키보드</p>

  <div class="section">
    <h2>사용법</h2>
    <div class="step"><b>1.</b> 아래 <b>"키보드 코드 복사"</b> 버튼을 탭합니다.</div>
    <div class="step"><b>2.</b> 게임 사이트로 이동합니다 (예: DCSS 웹타일).</div>
    <div class="step"><b>3.</b> 주소창을 탭하고, 주소를 지운 뒤 붙여넣기합니다.</div>
    <div class="step"><b>4.</b> 주소 맨 앞에 <b>javascript:</b> 가 지워졌다면 직접 입력한 뒤 이동합니다.</div>
    <div class="step"><b>5.</b> 화면 우하단의 <b>⌨ 버튼</b>을 탭하면 키보드가 나타납니다.</div>
  </div>

  <div class="section">
    <h2>북마클릿 코드</h2>
    <div class="url-box" id="bookmarklet-code"></div>
    <div class="btn-row">
      <button class="btn btn-primary" id="copy-btn">키보드 코드 복사</button>
    </div>
    <p class="note">또는 이 코드를 북마크의 URL로 저장하면<br>한 번의 탭으로 키보드를 불러올 수 있습니다.</p>
  </div>

  <div class="section">
    <h2>바로 열기</h2>
    <div class="step">게임 URL을 입력하면 키보드가 포함된 페이지를 엽니다.</div>
    <form id="go-form" style="display:flex;gap:8px;margin-top:12px;">
      <input type="url" id="go-url" placeholder="https://crawl.nemelex.cards/"
        style="flex:1;background:#222;border:1px solid #444;border-radius:8px;color:#eee;padding:10px;font-size:14px;outline:none;">
      <button type="submit" class="btn btn-primary" style="flex:0;padding:10px 18px;">Go</button>
    </form>
  </div>

  <div class="section demo">
    <button id="demo-btn">이 페이지에서 키보드 테스트</button>
  </div>

  <script>
    var OVERLAY_URL = 'https://jinha1226.github.io/overlay.js';
    var code = "javascript:void(document.body.appendChild(Object.assign(document.createElement('script'),{src:'" + OVERLAY_URL + "?t='+Date.now()})))";

    document.getElementById('bookmarklet-code').textContent = code;

    document.getElementById('copy-btn').addEventListener('click', function() {
      navigator.clipboard.writeText(code).then(function() {
        document.getElementById('copy-btn').textContent = '복사됨!';
        setTimeout(function() { document.getElementById('copy-btn').textContent = '키보드 코드 복사'; }, 2000);
      });
    });

    document.getElementById('demo-btn').addEventListener('click', function() {
      var s = document.createElement('script');
      s.src = OVERLAY_URL + '?t=' + Date.now();
      document.body.appendChild(s);
    });

    document.getElementById('go-form').addEventListener('submit', function(e) {
      e.preventDefault();
      var url = document.getElementById('go-url').value.trim();
      if (!url) return;
      if (!/^https?:\/\//i.test(url)) url = 'https://' + url;
      // Open game with keyboard injected via URL fragment trick
      window.location.href = url;
      // After navigation, user needs to run bookmarklet
    });

    // Register SW for PWA install
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js', { updateViaCache: 'none' });
    }
  </script>
</body>
</html>
